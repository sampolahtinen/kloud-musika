# Migration `20200324141825-cdfddd`

This migration has been generated by Sampo Lahtinen at 3/24/2020, 2:18:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Track_trackMetadata"

ALTER TABLE "public"."Track" DROP CONSTRAINT IF EXiSTS "Track_trackMetadata_fkey",
DROP COLUMN "trackMetadata",
ADD COLUMN "metadata" integer   ;

CREATE UNIQUE INDEX "Track_metadata" ON "public"."Track"("metadata")

ALTER TABLE "public"."Track" ADD FOREIGN KEY ("metadata")REFERENCES "public"."TrackMetadata"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200324141117-cdfd..20200324141825-cdfddd
--- datamodel.dml
+++ datamodel.dml
@@ -1,8 +1,8 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://sampo@localhost:5432/kloud_muzika"
 }
 generator client {
   provider = "prisma-client-js"
@@ -22,14 +22,22 @@
   name  String?
   posts Post[]
 }
+
+model TrackMetadata {
+  id                 Int    @id @default(autoincrement())
+  track              Track
+  original_file_path String
+  direct_link        String
+}
+
 model Track {
-  id            Int            @id @default(autoincrement())
-  title         String
-  fileId        String?
-  artist        Artist
-  trackMetadata TrackMetadata?
+  id       Int            @id @default(autoincrement())
+  title    String
+  fileId   String?
+  artist   Artist
+  metadata TrackMetadata?
 }
 model Artist {
   id      Int     @id @default(autoincrement())
@@ -40,12 +48,5 @@
 model Album {
   id           Int     @id @default(autoincrement())
   name         String
   release_date String?
-}
-
-model TrackMetadata {
-  id                 Int    @id @default(autoincrement())
-  track              Track
-  original_file_path String
-  direct_link        String
 }
```


